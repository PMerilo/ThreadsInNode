// Set new default font family and font color to mimic Bootstrap's default styling
Chart.defaults.global.defaultFontFamily = 'Nunito', '-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif';
Chart.defaults.global.defaultFontColor = '#858796';

function number_format(number, decimals, dec_point, thousands_sep) {
  // *     example: number_format(1234.56, 2, ',', ' ');
  // *     return: '1 234,56'
  number = (number + '').replace(',', '').replace(' ', '');
  var n = !isFinite(+number) ? 0 : +number,
    prec = !isFinite(+decimals) ? 0 : Math.abs(decimals),
    sep = (typeof thousands_sep === 'undefined') ? ',' : thousands_sep,
    dec = (typeof dec_point === 'undefined') ? '.' : dec_point,
    s = '',
    toFixedFix = function (n, prec) {
      var k = Math.pow(10, prec);
      return '' + Math.round(n * k) / k;
    };
  // Fix for IE parseFloat(0.55).toFixed(0) = 0;
  s = (prec ? toFixedFix(n, prec) : '' + Math.round(n)).split('.');
  if (s[0].length > 3) {
    s[0] = s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g, sep);
  }
  if ((s[1] || '').length < prec) {
    s[1] = s[1] || '';
    s[1] += new Array(prec - s[1].length + 1).join('0');
  }
  return s.join(dec);
}


// Your Products Bar Chart
// var getInventoryData = $.get('/datapipeline/InventoryReport')
// var ctx6 = document.getElementById("InventoryReportBarchart");
// getInventoryData.done(function(data){
//     var stock = []
//     var name = []
//     // console.log(data.data)
//     data.data.forEach(element => {
//       stock.push(element["Stocks"])
//       name.push(element["ProductName"])
//       // console.log(element["Stocks"])
//       // console.log("hi")
      
//     });
  
//       var mybarChart = new Chart(ctx6, {
//       type: 'bar',
//       data: {
//         labels: name,
//         datasets: [{
//           label: "Current Stock",
//           lineTension: 0.3,
//           backgroundColor: "red",
//           borderColor: "rgba(78, 115, 223, 1)",
//           pointRadius: 3,
//           pointBackgroundColor: "rgba(78, 115, 223, 1)",
//           pointBorderColor: "rgba(78, 115, 223, 1)",
//           pointHoverRadius: 3,
//           pointHoverBackgroundColor: "rgba(78, 115, 223, 1)",
//           pointHoverBorderColor: "rgba(78, 115, 223, 1)",
//           pointHitRadius: 10,
//           pointBorderWidth: 2,
//           data: stock,
//         }],
//       },
//       options: {
//         maintainAspectRatio: false,
//         layout: {
//           padding: {
//             left: 10,
//             right: 25,
//             top: 25,
//             bottom: 0
//           }
//         },
//         scales: {
//           xAxes: [{
//             time: {
//               unit: 'productname'
//             },
//             gridLines: {
//               display: false,
//               drawBorder: false
//             },
//             ticks: {
//               maxTicksLimit: 7
//             }
//           }],
//           yAxes: [{
//             ticks: {
//               maxTicksLimit: 5,
//               padding: 10,
//               // Include a dollar sign in the ticks
//               callback: function(value, index, values) {
//                 return number_format(value);
//               }
//             },
//             gridLines: {
//               color: "rgb(234, 236, 244)",
//               zeroLineColor: "rgb(234, 236, 244)",
//               drawBorder: false,
//               borderDash: [2],
//               zeroLineBorderDash: [2]
//             }
//           }],
//         },
//         legend: {
//           display: false
//         },
//         tooltips: {
//           backgroundColor: "rgb(255,255,255)",
//           bodyFontColor: "#858796",
//           titleMarginBottom: 10,
//           titleFontColor: '#6e707e',
//           titleFontSize: 14,
//           borderColor: '#dddfeb',
//           borderWidth: 1,
//           xPadding: 15,
//           yPadding: 15,
//           displayColors: false,
//           intersect: false,
//           mode: 'index',
//           caretPadding: 10,
//           callbacks: {
//             label: function(tooltipItem, chart) {
//               var datasetLabel = chart.datasets[tooltipItem.datasetIndex].label || '';
//               return datasetLabel + " "+ number_format(tooltipItem.yLabel);
//             }
//           }
//         }
//       }
//     });

//   })


// Customer Satisfaction Bar Chart
var getCustomerSatisfactionData = $.get('/datapipeline/CustomerSatisfaction')
var ctx7 = document.getElementById("CustomerSatisfactionBarchart");
getCustomerSatisfactionData.done(function(data){
    var ratings = []
    var labels = ["1 Star", "2 Star", "3 Star", "4 Star", "5 Star"]
    
    // console.log(data.data)
    data.data.forEach(element => {
      ratings.push(element["1 Star Rating"])
      ratings.push(element["2 Star Rating"])
      ratings.push(element["3 Star Rating"])
      ratings.push(element["4 Star Rating"])
      ratings.push(element["5 Star Rating"])

      
      
    });
  
      var mybarChart = new Chart(ctx7, {
      type: 'bar',
      data: {
        labels: labels,
        legend: {
          
          display: true
        },
        datasets: [{
          label: "Number Of Users",
          lineTension: 0.3,
          backgroundColor: ["red", "orange", "yellow", "green", "blue"],
          borderColor: "rgba(78, 115, 223, 1)",
          pointRadius: 3,
          pointBackgroundColor: "rgba(78, 115, 223, 1)",
          pointBorderColor: "rgba(78, 115, 223, 1)",
          pointHoverRadius: 3,
          pointHoverBackgroundColor: "rgba(78, 115, 223, 1)",
          pointHoverBorderColor: "rgba(78, 115, 223, 1)",
          pointHitRadius: 10,
          pointBorderWidth: 2,
          data: ratings,
        }],
      },
      options: {
        maintainAspectRatio: false,
        layout: {
          padding: {
            left: 10,
            right: 25,
            top: 25,
            bottom: 0
          }
        },
        scales: {
          xAxes: [{
            time: {
              unit: 'number'
            },
            gridLines: {
              display: false,
              drawBorder: false
            },
            ticks: {
              maxTicksLimit: 7
            }
          }],
          
          
          yAxes: [{
            ticks: {
              maxTicksLimit: 5,
              min:0,
              padding: 10,
              // Include a dollar sign in the ticks
              callback: function(value, index, values) {
                return number_format(value);
              }
            },
            gridLines: {
              color: "rgb(234, 236, 244)",
              zeroLineColor: "rgb(234, 236, 244)",
              drawBorder: false,
              borderDash: [2],
              zeroLineBorderDash: [2]
            }
          }],
        },
        tooltips: {
          backgroundColor: "rgb(255,255,255)",
          bodyFontColor: "#858796",
          titleMarginBottom: 10,
          titleFontColor: '#6e707e',
          titleFontSize: 14,
          borderColor: '#dddfeb',
          borderWidth: 1,
          xPadding: 15,
          yPadding: 15,
          displayColors: true,
          intersect: false,
          mode: 'index',
          caretPadding: 10,
          callbacks: {
            label: function(tooltipItem, chart) {
              var datasetLabel = chart.datasets[tooltipItem.datasetIndex].label || '';
              return datasetLabel + " "+ number_format(tooltipItem.yLabel);
            }
          }
        }
      }
    });

  })


// Customer Satisfaction Bar Chart
var getCustomerAgesData = $.get('/datapipeline/SurveyQuestionsAge')
var ctx8 = document.getElementById("SurveyQuestionsAge");
getCustomerAgesData.done(function(data){
    var ages = []
    var labels = ["Above 60","40 to 60","20 to 40","Below 20"]
    
    // console.log(data.data)
    data.data.forEach(element => {
      ages.push(element["Above 60"])
      ages.push(element["40 to 60"])
      ages.push(element["20 to 40"])
      ages.push(element["Below 20"])

      
    });
  
      var mybarChart = new Chart(ctx8, {
      type: 'bar',
      data: {
        labels: labels,
        datasets: [{
          label: "Number Of Users",
          lineTension: 0.3,
          backgroundColor: ["red", "orange", "yellow", "green"],
          borderColor: "rgba(78, 115, 223, 1)",
          pointRadius: 3,
          pointBackgroundColor: "rgba(78, 115, 223, 1)",
          pointBorderColor: "rgba(78, 115, 223, 1)",
          pointHoverRadius: 3,
          pointHoverBackgroundColor: "rgba(78, 115, 223, 1)",
          pointHoverBorderColor: "rgba(78, 115, 223, 1)",
          pointHitRadius: 10,
          pointBorderWidth: 2,
          data: ages,
        }],
      },
      options: {
        maintainAspectRatio: false,
        layout: {
          padding: {
            left: 10,
            right: 25,
            top: 25,
            bottom: 0
          }
        },
        scales: {
          xAxes: [{
            time: {
              unit: 'number'
            },
            gridLines: {
              display: false,
              drawBorder: false
            },
            ticks: {
              maxTicksLimit: 7
            }
          }],
          yAxes: [{
            ticks: {
              maxTicksLimit: 5,
              min:0,
              padding: 10,
              // Include a dollar sign in the ticks
              callback: function(value, index, values) {
                return number_format(value);
              }
            },
            gridLines: {
              color: "rgb(234, 236, 244)",
              zeroLineColor: "rgb(234, 236, 244)",
              drawBorder: false,
              borderDash: [2],
              zeroLineBorderDash: [2]
            }
          }],
        },
        legend: {
          display: false
        },
        tooltips: {
          backgroundColor: "rgb(255,255,255)",
          bodyFontColor: "#858796",
          titleMarginBottom: 10,
          titleFontColor: '#6e707e',
          titleFontSize: 14,
          borderColor: '#dddfeb',
          borderWidth: 1,
          xPadding: 15,
          yPadding: 15,
          displayColors: true,
          intersect: false,
          mode: 'index',
          caretPadding: 10,
          callbacks: {
            label: function(tooltipItem, chart) {
              var datasetLabel = chart.datasets[tooltipItem.datasetIndex].label || '';
              return datasetLabel + " "+ number_format(tooltipItem.yLabel);
            }
          }
        }
      }
    });

  })


